# =================================================================
# 테스트 환경 설정 (Profile: test)
# 용도: JUnit, 통합 테스트 실행 시 사용
# 활성화: @ActiveProfiles("test") 또는 --spring.profiles.active=test
# =================================================================

# 서버 포트 설정 (테스트용 랜덤 포트)
server.port=0

# 테스트용 In-Memory H2 데이터베이스
spring.datasource.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.username=sa
spring.datasource.password=
spring.datasource.driver-class-name=org.h2.Driver

# JPA/Hibernate 설정 (테스트용)
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
spring.jpa.hibernate.naming.implicit-strategy=org.hibernate.boot.model.naming.ImplicitNamingStrategyLegacyJpaImpl

# H2 Console 활성화 (테스트 디버깅용)
spring.h2.console.enabled=true

# Redis 설정 (테스트용 - Embedded Redis 또는 Mock)
spring.redis.host=localhost
spring.redis.port=6370
spring.redis.timeout=1000ms

# Spring Security 완전 비활성화
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration

# 로깅 설정 (테스트용 - 최소 로그)
logging.level.com.example.LAGO=WARN
logging.level.org.hibernate.SQL=WARN
logging.level.org.springframework=WARN

# FinBERT 테스트용 Mock 설정
finbert.server.host=http://localhost:5001
finbert.server.analyze-endpoint=/analyze
finbert.server.health-endpoint=/health
finbert.client.timeout=5000

# 테스트 데이터 초기화
spring.jpa.defer-datasource-initialization=true
spring.sql.init.mode=always
